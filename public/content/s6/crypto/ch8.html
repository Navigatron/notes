<!DOCTYPE html>
<html lang=" en-US">

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		
	<!-- <script type="text/x-mathjax-config">
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [ ['$','$'], ["\\(","\\)"] ],
				processEscapes: true
			}
		});
	</script> -->
	<script>
		MathJax = {
			tex: {
				inlineMath: [['$', '$'], ['\\(', '\\)']]
			}
		};
	</script>
	<!-- <script
		type="text/javascript"
		charset="utf-8"
		src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
		>
	</script> -->
	<script
		type="text/javascript"
		id="MathJax-script"
		async
		src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
		>
	</script>
	<!-- <script
		type="text/javascript"
		charset="utf-8"
		src="https://vincenttam.github.io/javascripts/MathJaxLocal.js"
		>
	</script> -->

		


		<!--[if lt IE 9]>
			<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
		<![endif]-->
		
		<style>
			@import url('https://fonts.googleapis.com/css2?family=Arvo&family=Fira+Mono&family=Open+Sans&display=swap');
		</style>
		<link rel="stylesheet" href="/styles/index.css?v=1657689426810">

		<!-- Code Highlighting -->
		<link rel="stylesheet" href="https://raw.githubusercontent.com/PrismJS/prism-themes/master/themes/prism-one-light.css">
	</head>

	<body>
		<main>
			
			


<article>
	<p><a href="../../../">Home</a> &gt; <a href="./">Crypto</a> &gt; Chapter 8 - PKI / Logs / DHKE</p>
<h1>Chapter 8 - PKI / Logs / DHKE</h1>
<p>RSA uses factoring big things as its <em>one-way</em> function. There's another one-way function called the <em>Discrete Logarithm Problem</em> (DLP).</p>
<p>We're gonna hit:</p>
<ul>
<li>Diffie-Hellman key exchange</li>
<li>Cyclic groups</li>
<li>The discrete logarithm problem</li>
<li>Encryption with the Elgamal scheme</li>
</ul>
<h2>8.1 - Diffie-Hellman Key Exchange</h2>
<p>This lets two parties exchange keys over an insecure channel.</p>
<p>Exponentiation in $\Bbb Z_p^*$, where $p$ is prime, is a one-way function. Also, it's commutative:</p>
<p>$$
k = (\alpha ^x)^y \equiv (\alpha ^y)^x \bmod p
$$</p>
<p>The value $k$ can be used as a key.</p>
<p><strong>Setup</strong>:</p>
<ol>
<li>Choose a large prime $p$</li>
<li>Choose an integer $\alpha \in {2,3,...,p-2}$</li>
<li>Publish $p$ and $\alpha$</li>
</ol>
<p><strong>Alice</strong>:</p>
<ol>
<li>Choose $a = k_{pr,A} \in {2,...,p-2}$</li>
<li>Compute $A = k_{pub,A} \equiv \alpha ^a \bmod p$</li>
<li>Send $A$, Receive $B$</li>
<li>Compute $k_{AB} = k_{pub,B}^{k_{pr,A}} \equiv B^a \bmod p$</li>
</ol>
<p><strong>Bob</strong>:</p>
<ol>
<li>Choose $b = k_{pr,B} \in {2,...,p-2}$</li>
<li>Compute $B = k_{pub,B} \equiv \alpha ^b \bmod p$</li>
<li>Send $B$, Receive $A$</li>
<li>Compute $k_{AB} = k_{pub,A}^{k_{pr,B}} \equiv A^b \bmod p$</li>
</ol>
<p>In english:</p>
<ul>
<li>Each side has $\alpha$ and $p$</li>
<li>Each side chooses a secret value</li>
<li>Each side crates a public value, which is $\alpha^{secret}$</li>
<li>They trade public values</li>
<li>Then, they raise the other's public value to their own secret.</li>
<li>End result: Both sides have $\alpha$ raised to both secret values.</li>
</ul>
<p>$p$ should be a big prime, Generated in a similar way to in RSA. 1024 bits or more is good. $\alpha$ needs to be a primitive element. We'll hit that soon.</p>
<h2>8.2 - Algebra</h2>
<h3>8.2.1 - Groups</h3>
<p>A group is a set of elements, $G$, and an operation $\circ$ that combines two elements.</p>
<ul>
<li>Closed: $a \circ b = c \in G$</li>
<li>Associative: $(a \circ b) \circ c = a \circ (b \circ c)$</li>
<li>Neutral Element: $a \circ 1 = 1 \circ a = a$ for all $a \in G$</li>
<li>Inverse Element: $a \circ a^{-1} = 1$ for all $a \in G$</li>
<li>Can be abelian, if $a \circ b = b \circ a$ for all $a,b \in G$
<ul>
<li>so basically, no division</li>
</ul>
</li>
</ul>
<p>Operation $\circ$ is typically either multiply or add.</p>
<blockquote>
<p><strong>Theorem 8.2.1</strong></p>
<p>The set $\Bbb Z_n^*$, having all $i=0,1,...,n-1$ where $gcd(i,n)=1$ is an abelian group under multiplication modulo $n$.</p>
</blockquote>
<p>So basically, a group $\Bbb Z_n^*$ has all the integers coprime to $n$. If $n$ is prime, then it's every int smaller than $n$, otherwise theres a few missing.</p>
<h3>8.2.2 - Cyclic groups</h3>
<p>A group is finite if it has a finite number of elements. The size of the group, $|G|$, is called its <em>order</em> or <em>cardinality</em>.</p>
<blockquote>
<p>It's whack that order can be written ord(G) or |G|.
The book seems to use |G| for groups, and ord(a) for elements.</p>
</blockquote>
<p>The group $\Bbb Z_n^*$ has all integers smaller than $n$ that are coprime to $n$. Recall that euler's phi function is defined as the count of all integers smaller than $n$ that are coprime to $n$. Therefore:</p>
<p>$$
order(\Bbb Z_n^*) = \phi(n)
$$</p>
<p>Recall that, if $n$ can be expressed as $p^a$, then:</p>
<p>$$
\phi(p^a) = p^a-p^{a-1}
$$</p>
<blockquote>
<p><strong>Definition 8.2.3</strong></p>
<p>The order $ord(a)$ of an element is the smallest number $k$ such that $a^k=1$.</p>
</blockquote>
<p>If you aren't using multiplication, define $a^k$ as $a \circ a$, $k$ times. Also replace 1 with the neutral element of whatever group you're using.</p>
<p>The biggest order an element can have is the order of the group its in.</p>
<p>Example: $Z_{11}^*$, and $a=3$.</p>
<p>Take a look at this shit:</p>
<p>$$
a^1 = 3\\
a^2 = a^1 \cdot a = 9\\
a^3 = a^2 \cdot a = 27 \equiv 5 \bmod 11\\
a^4 = a^3 \cdot a = 15 \equiv 4 \bmod 11\\
a^5 = a^4 \cdot a = 12 \equiv 1 \bmod 11\\
a^6 = a^1 \cdot 1 = 3 \equiv 3 \bmod 11\\
a^7 = a^2 \cdot 1 = 3 \equiv 9 \bmod 11\\
a^8 = a^3 \cdot 1 = 3 \equiv 5 \bmod 11\\
a^9 = a^4 \cdot 1 = 3 \equiv 4 \bmod 11\\
a^10 = 1 \cdot 1 = 3 \equiv 1 \bmod 11\\
a^11 = a^1 \cdot 1 = 3 \equiv 3 \bmod 11
$$</p>
<p>See how once we hit $k=5$, it became one, which meant increasing $k$ just means we repeat where we've already been. So - $a$ <em>GENERATES</em> the sequence ${3,9,5,4,1}$.</p>
<p>So, we have our group, and elements of said group can generate other sets.</p>
<blockquote>
<p><strong>Definition 8.2.4</strong></p>
<p>A group $G$ is a <em>Cyclic group</em> is it has an element $\alpha$ where $ord(\alpha)=ord(G)$. Such elements are called <em>Primitive Elements</em>, and/or <em>Generators</em>.</p>
</blockquote>
<p>Recall that $ord(G)$ is the biggest that $ord(\alpha)$ can be.</p>
<p>If $\alpha$ of $G$ has max order (is a generator), then every element in $G$ can be written as $\alpha^i$ - aka $\alpha$ <em>generates</em> the entire group it's in. Whack!</p>
<p>In the group $\Bbb Z_11^*$, $a=2$ generates the whole group. So, the group is cyclical. Now look at <em>this</em>:</p>
<table>
<thead>
<tr>
<th>$i$</th>
<th>$2^i$</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>8</td>
</tr>
<tr>
<td>4</td>
<td>5</td>
</tr>
<tr>
<td>5</td>
<td>10</td>
</tr>
<tr>
<td>6</td>
<td>9</td>
</tr>
<tr>
<td>7</td>
<td>7</td>
</tr>
<tr>
<td>8</td>
<td>3</td>
</tr>
<tr>
<td>9</td>
<td>6</td>
</tr>
<tr>
<td>10</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>2 is a generator of the group, but it generates it in a seemingly random order. This is the basis of DLP cryptosystems.</p>
<blockquote>
<p><strong>Theorem 8.2.2</strong></p>
<p>For every prime $p$, Group $\Bbb Z_p^*$ is an abelian finite cyclic group.</p>
</blockquote>
<p>Now that's pretty wild.</p>
<blockquote>
<p><strong>Theorem 8.2.3</strong></p>
<p>If $G$ is a finite group, then for every $a \in G$:</p>
<ul>
<li>$a^{|G|} = 1$</li>
<li>$ord(a)$ divides $|G|$</li>
</ul>
</blockquote>
<p>So, if we use our base 11 group again, and it has order 10, and only 1, 2, 5, and 10 divide 10, then we know the order of every element has to be either 1, 2, 5, or 10.</p>
<p>It's also really wild that any element to the 10th power is 1.</p>
<blockquote>
<p><strong>Theorem 8.2.4</strong></p>
<p>If $G$ is a finite cyclic group, then...</p>
<ul>
<li>The number of primitive elements is $\phi(|G|)$</li>
<li>If $|G|$ is prime, every element other than 1 is primitive.</li>
</ul>
</blockquote>
<p>So in our base-11 group, there are $\phi(10)=4$ primitive elements.</p>
<p>If the group cardinality were prime $p$, everything would be primitive (except 1). If everything is primitive, then the order of everything is the order of the group, which is $p$.</p>
<h3>8.2.3 - Subgroups</h3>
<blockquote>
<p><strong>Theorem 8.2.5</strong></p>
<p>If $G$ is a cyclic subgroup, then every element $a \in G$ generates a cyclic subgroup with $ord(a)$ elements.</p>
</blockquote>
<p>If the order of the group is prime $p$, then every element except for 1 has an order of $p$.</p>
<blockquote>
<p><strong>Theorem 8.2.6</strong>: Lagrange's theorem</p>
<p>If H is a subgroup of G, then $|H|$ divides $|G|$</p>
</blockquote>
<p>Here's a big one:</p>
<blockquote>
<p><strong>Theorem 8.2.7</strong></p>
<p>Let G be a finite cyclic group, order $n$. $\alpha$ is a generator of G.</p>
<p>For every int k that divides n, there exists exactly one cyclic subgroup H of G of order k. H can be generated from $\alpha^{n/k}$</p>
<p>H holds exactly the elements $a \in G$ where $a^k=1$.</p>
<p>There are no other subgroups.</p>
</blockquote>
<p>This makes it easy to generate a subgroup of a desired size (that divides n at least), if you have a generator of your starting group.</p>
<h2>8.3 - The Discrete Logarithm Problem</h2>
<p>Yep. Here we go.</p>
<h3>8.3.1 - in prime fields</h3>
<p>Consider $\Bbb Z_p^*$, where $p$ is prime.</p>
<blockquote>
<p><strong>Definition 8.3.1</strong></p>
<p>Given $\Bbb Z_p^*$, primitive element $\alpha$, and vanilla element $\beta$,
The DLP is finding integer $x$, where $1 \leq x \leq p-1$ such that:</p>
<p>$$
\alpha^x \equiv \beta \bmod p
$$</p>
</blockquote>
<p>Rename x to k and $\beta$ to 1 and this looks a lot like trying to find the order of $\alpha$. Hmmm.</p>
<p>Since $\alpha$ is a primitive element, we know that x must exist.</p>
<p>I failed the logarithm section in high school. This looks particularly scary:</p>
<p>$$
x = \log_{\alpha} \beta \bmod p
$$</p>
<p>If we have $\alpha$, x, and $p$, then it's easy to compute $\beta$. That's just the <code>squam</code> function. But yes, turning it around is heckin tough.</p>

</article>
			
			<footer>
				<hr>
				<p>
					&copy; <a href="https://ewitherington.me">Ethan Witherington</a> 2022
				</p>
			</footer>
		</main>
	</body>

</html>