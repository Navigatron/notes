<!DOCTYPE html>
<html lang=" en-US">

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		
	<!-- MathJax disabled on this page -->

		


		<!--[if lt IE 9]>
			<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
		<![endif]-->
		
		<style>
			@import url('https://fonts.googleapis.com/css2?family=Arvo&family=Fira+Mono&family=Open+Sans&display=swap');
		</style>
		<link rel="stylesheet" href="/styles/index.css?v=1657689426778">

		<!-- Code Highlighting -->
		<link rel="stylesheet" href="https://raw.githubusercontent.com/PrismJS/prism-themes/master/themes/prism-one-light.css">
	</head>

	<body>
		<main>
			
			


<article>
	<p><a href="../../../">Index</a> &gt; <a href="./">Malware</a> &gt; 2021-01-26: Terminology</p>
<h1>2021-01-26: Terminology</h1>
<p>C and C++ are the top two languages for malware development, for three reasons:</p>
<ol>
<li>No Dependencies - No runtimes or interpreters.</li>
<li>High level of control - directly call (and abuse) OS APIs.</li>
<li>Tiny file size - faster loading, easier to hide</li>
</ol>
<p><strong>Downloaders</strong> download other malware and run it. They infiltrate target territory and then bring in their friends. In the windows API, <code>URLDownloadtoFileA</code> is often chained with <code>WinExec</code> - download and execute.</p>
<p>A <strong>Launcher</strong> or <strong>Loader</strong> is an executable that installs malware for immediate or future use. The loader is packaged with the malware it installs. Launchers commonly inject the malware into already running processes to take over their memory and privileges.</p>
<blockquote>
<p>If a downloader also launches malware, can it use the same techniques? Is the only effective difference the inclusion/downloading of the payload?</p>
</blockquote>
<p>A <strong>Backdoor</strong> is an attacker-installed way of accessing a system, other than their initial method.</p>
<p>A <strong>Rootkit</strong> is a method of maintaining root-level access to a machine.</p>
<p>A <strong>Reverse Shell</strong> is a connection from the target system back to the attacker. Target systems are typically behind some method of blocking incoming connections, so the attacker can't connect directly. However, the target can start outgoing connections to an attacker server.</p>
<p>Malware likes to open a <em>socket</em> to the attacker, then bind the IO streams to a new <code>CMD.EXE</code> process with the window suppressed.</p>
<p>There are three <em>default</em> <strong>File Descriptors</strong>:</p>
<ol start="0">
<li>STDIN - the process's input stream
<ul>
<li>In a default terminal, this is bound to the keyboard.</li>
</ul>
</li>
<li>STDOUT - the process's output stream
<ul>
<li>Default is the terminal screen</li>
</ul>
</li>
<li>STDERR - for error messages
<ul>
<li>Default is also the terminal screen</li>
</ul>
</li>
</ol>
<p>There is a fun thing called a <strong>Multi-Threaded Reverse Shell</strong>. Data from the socket flows through thead1, then stdin of the processes, stdout of the process, then thread2, then back to the socket. The threads perform decryption / encryption to disguise the traffic over the wire.</p>
<pre><code class="language-dot">digraph d{
	t1 [label=&quot;decryption thread&quot;];
	t2 [label=&quot;encryption thread&quot;];
	proc [label=&quot;CMD.EXE&quot;];
	socket -&gt; t1 -&gt; proc -&gt; t2;
	t2 -&gt; socket;
}
</code></pre>
<p>A <strong>Trojan</strong> is an evil program that pretends to be nice. This helps it blend in and avoid detection.</p>
<p>A <strong>RAT</strong> could be a remote administration tool - but it could also be a <em>remote access trojan</em>. This is a special trojan that allows, well, remote access.</p>
<p>A <strong>Botnet</strong> is a collection of many infected machines that can all be controlled at once.</p>
<p>In <strong>Dynamic Linking</strong>, the libraries and functions the binary uses are loaded with the binary, but aren't included <em>inside</em> the binary.</p>
<p>In <strong>Runtime Linking</strong>, the binary calls out to the libraries it needs when it needs them. The binary still needs at least two functions to do this:</p>
<ul>
<li><code>LoadLibrary</code></li>
<li><code>GetProcAddress</code></li>
</ul>
<blockquote>
<p>Wow, I need to go learn some x86</p>
</blockquote>
<hr>
<p><a href="../../../">Index</a> &gt; <a href="./">Malware</a> &gt; 2021-01-26: Terminology</p>

</article>
			
			<footer>
				<hr>
				<p>
					&copy; <a href="https://ewitherington.me">Ethan Witherington</a> 2022
				</p>
			</footer>
		</main>
	</body>

</html>