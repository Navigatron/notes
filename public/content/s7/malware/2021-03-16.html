<!DOCTYPE html>
<html lang=" en-US">

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		
	<!-- MathJax disabled on this page -->

		


		<!--[if lt IE 9]>
			<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
		<![endif]-->
		
		<style>
			@import url('https://fonts.googleapis.com/css2?family=Arvo&family=Fira+Mono&family=Open+Sans&display=swap');
		</style>
		<link rel="stylesheet" href="/styles/index.css?v=1657689426783">

		<!-- Code Highlighting -->
		<link rel="stylesheet" href="https://raw.githubusercontent.com/PrismJS/prism-themes/master/themes/prism-one-light.css">
	</head>

	<body>
		<main>
			
			


<article>
	<p><a href="../../../">Index</a> &gt; <a href="./">Course</a> &gt; Mon Mar 15 2021 20:00:00 GMT-0400 (Eastern Daylight Time):</p>
<h1>Mon Mar 15 2021 20:00:00 GMT-0400 (Eastern Daylight Time):</h1>
<p>Things are due <em>today</em>:</p>
<ul>
<li>Lab 3</li>
<li>Lab 4</li>
<li>Lab 5</li>
</ul>
<h2>Depths of Analysis</h2>
<p>Dynamic analysis is useful, and can generate some detection rules - but static analysis can reveal some extra things to build even better detection rules.</p>
<p>You can analyze malware at different depths:</p>
<ul>
<li>Surface Analysis
<ul>
<li>strings</li>
<li>redshot, searching for storage artifacts</li>
<li>The names of imported functions</li>
</ul>
</li>
<li>Communication method coverage
<ul>
<li>Understand the communications going on</li>
<li>Wireshark capture</li>
</ul>
</li>
<li>Operational replication
<ul>
<li>Able to emulate the malware for c2 outreach</li>
</ul>
</li>
<li>Code coverage
<ul>
<li>Understanding every block of code</li>
<li>But that will take forever</li>
<li>So just understand the important parts</li>
</ul>
</li>
</ul>
<h2>Attackers mimic existing protocols</h2>
<p>HTTP and DNS are the most common protocols on the internet - so malware will use them too, to blend in. Try this DNS request:</p>
<pre><code>www.thepasswordisflapjack.evil.com
</code></pre>
<p>The payload information is included as a subdomain, the evil dns server can easily extract the info.</p>
<blockquote>
<p>ICMP Payload is another popular exfil technique.</p>
</blockquote>
<p>Advanced attackers use native syscalls to do communication, so that it's identical to valid traffic.</p>
<p>Responses can also be sneaky - embedding commands in html comments is a common technique.</p>
<h2>Other malware techniques</h2>
<p>Construct a profile of the victim, either by encoding or hashing some finger-printable characteristics. Send this in the handshake, so the C2 infrastructure knows which victim it's talking too.</p>
<p>Malware on an onion site can extract a mac address from dhcp traffic - then, when the gov seizes the criminal's machines, they can correlate mac addresses to build a case.</p>
<blockquote>
<p>&quot;The best way to use IDA Pro, is to go to strings, or to imports, find something interesting, and use CTRL+X to see the references.&quot; - Prof.</p>
</blockquote>
<hr>
<p><a href="../../../">Index</a> &gt; <a href="./">Course</a> &gt; Mon Mar 15 2021 20:00:00 GMT-0400 (Eastern Daylight Time):</p>

</article>
			
			<footer>
				<hr>
				<p>
					&copy; <a href="https://ewitherington.me">Ethan Witherington</a> 2022
				</p>
			</footer>
		</main>
	</body>

</html>