<!DOCTYPE html>
<html lang=" en-US">

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		
	<!-- MathJax disabled on this page -->

		


		<!--[if lt IE 9]>
			<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
		<![endif]-->
		
		<style>
			@import url('https://fonts.googleapis.com/css2?family=Arvo&family=Fira+Mono&family=Open+Sans&display=swap');
		</style>
		<link rel="stylesheet" href="/styles/index.css?v=1657689426783">

		<!-- Code Highlighting -->
		<link rel="stylesheet" href="https://raw.githubusercontent.com/PrismJS/prism-themes/master/themes/prism-one-light.css">
	</head>

	<body>
		<main>
			
			


<article>
	<p><a href="../../../">Index</a> &gt; <a href="./">Course</a> &gt; Wed Mar 17 2021 20:00:00 GMT-0400 (Eastern Daylight Time):</p>
<h1>Wed Mar 17 2021 20:00:00 GMT-0400 (Eastern Daylight Time):</h1>
<ul>
<li>Finish the Chapter!</li>
<li>Do some lab work</li>
</ul>
<h2>Regex</h2>
<ul>
<li>Regular characters match regular characters
<ul>
<li><code>guacamole</code> matches <code>guacamole</code>, what do you expect lol</li>
</ul>
</li>
<li><code>()</code> is a <em>Capture Group</em>
<ul>
<li>We can match a capture group multiple times with <code>{}</code></li>
<li><code>(){4}</code> matches 4 of the group</li>
<li><code>(){2,6}</code> matches 2, 3, 4, 5, or 6 of the group</li>
</ul>
</li>
<li><code>[]</code> is a <em>Character Set</em>
<ul>
<li><code>[0-9]</code> matches any single-digit number</li>
<li>Repetition works here too!</li>
<li><code>[0-9A-Fa-f]{6}</code> matches any 6-digit hex number (like colors!)</li>
</ul>
</li>
<li><code>|</code> is an <em>or</em> operator</li>
</ul>
<h3>Performance</h3>
<p>In last class's example, we're looking for two 58's (ascii for <code>:</code>). We match these in the regex. But, we don't want to run the regex matcher if we don't have to, so we <em>also</em> match the 58's in the snort rule.</p>
<p>If there aren't two 58's between 6 and 9 bytes apart, then we don't run the regex matcher at all.</p>
<h2>Back to the malware</h2>
<p>Looking at the malware from last class - After it makes its web request, the returned HTML contains a comment like:</p>
<pre><code>&lt;!-- adsrv?abcdefgh --&gt;
</code></pre>
<p>Running strings on the binary, we find <code>adsrv?</code> again. How does the malware check for this string in the html?</p>
<ol>
<li>Find <code>&lt;!--</code></li>
<li>Make sure it is followed by <code>adsrv?</code></li>
<li>Consume characters, until we find <code>--&gt;</code></li>
<li>Return the consumed characters as the command string.</li>
</ol>
<p>This malware could take 5 commands:</p>
<ul>
<li>sleep for 1 minute</li>
<li>sleep for 1 hour</li>
<li>sleep for 24 hours</li>
<li>Download and run an executable</li>
<li>Connect for a reverse shell</li>
</ul>
<h2>Target multiple components</h2>
<p>If we can make two separate rules for different parts of the traffic, you should! That way, if one component changes, the other might still be valid.</p>
<p>Think about which parts of the communication are hardest for the attacker to change.</p>
<h2>Midterm!</h2>
<ul>
<li>Duration: 1 week
<ul>
<li>Opens at 12:01 AM on Sunday the 21st</li>
<li>Closes at 11:59PM on Saturday the 27th</li>
</ul>
</li>
</ul>
<p>There are 33 questions. Multiple choice, true/false, category.</p>
<p>One page of notes is allowed, though it must be uploaded via photo at the end of the exam.</p>
<blockquote>
<p>&quot;The answers are abcdtf&quot; - Prof.</p>
</blockquote>
<p>Know these terms:</p>
<ul>
<li>Downloaders vs Launchers</li>
<li>Backdoors</li>
<li>Reverse Shells</li>
<li>RATs</li>
</ul>
<p>Know the differences:</p>
<ul>
<li>Process Injection</li>
<li>Process Replacement</li>
<li>DLL Injection</li>
<li>DLL Replacement?</li>
</ul>
<p>Know why a binary might want to do these things.</p>
<p>Be familiar with what these do:</p>
<ul>
<li>winlogon exe</li>
<li>appinit dll</li>
<li>user32 dll</li>
<li>service host exe</li>
<li>lsass exe</li>
</ul>
<p>Difference between:</p>
<ul>
<li>Local Hooks</li>
<li>Remote Hooks</li>
</ul>
<p>Be familiar with:</p>
<ul>
<li>XOR
<ul>
<li>clearing registers</li>
<li>cryptography</li>
<li>zero-preserving cryptography</li>
</ul>
</li>
<li>low-level vs multi-threaded reverse shells</li>
<li>Differences between (import address table) IAT hooking and inline hooking</li>
<li>Detours?
<ul>
<li>It's a microsoft library for editing binaries</li>
</ul>
</li>
<li>Trampolines</li>
<li>Base64</li>
<li>How entropy can identify cryptography</li>
<li>The ways attackers achieve persistence</li>
<li>Keyloggers
<ul>
<li>Polling vs Hooking</li>
<li>How they work</li>
</ul>
</li>
<li>Cryptographic Constants</li>
<li>Botnets, Trojan Horses, <strong>crasher-stealers</strong></li>
<li>Cryptographic Algorithms
<ul>
<li>Targeting Confidentiality vs Integrity require different techniques</li>
</ul>
</li>
</ul>
<h2>Lab 6</h2>
<p>Pick 14-1, 14-2, or 14-3: whichever you like, that's it. Due on April 1st.</p>
<hr>
<p><a href="../../../">Index</a> &gt; <a href="./">Course</a> &gt; Wed Mar 17 2021 20:00:00 GMT-0400 (Eastern Daylight Time):</p>

</article>
			
			<footer>
				<hr>
				<p>
					&copy; <a href="https://ewitherington.me">Ethan Witherington</a> 2022
				</p>
			</footer>
		</main>
	</body>

</html>