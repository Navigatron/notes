<!DOCTYPE html>
<html lang=" en-US">

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		
	<!-- MathJax disabled on this page -->

		


		<!--[if lt IE 9]>
			<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
		<![endif]-->
		
		<style>
			@import url('https://fonts.googleapis.com/css2?family=Arvo&family=Fira+Mono&family=Open+Sans&display=swap');
		</style>
		<link rel="stylesheet" href="/styles/index.css?v=1657689426782">

		<!-- Code Highlighting -->
		<link rel="stylesheet" href="https://raw.githubusercontent.com/PrismJS/prism-themes/master/themes/prism-one-light.css">
	</head>

	<body>
		<main>
			
			


<article>
	<p><a href="../../../">Index</a> &gt; <a href="./">Course</a> &gt; Mon Mar 08 2021 19:00:00 GMT-0500 (Eastern Standard Time):</p>
<h1>Mon Mar 08 2021 19:00:00 GMT-0500 (Eastern Standard Time):</h1>
<h2>MidTerm</h2>
<p>As soon as Chapter 14 ends, historically class 15. This is class 12.</p>
<p>The class before the midterm will be review, and the midterm will be available for an <em>entire week</em>.</p>
<blockquote>
<p>An entire week! That's awesome. Thanks prof!</p>
</blockquote>
<h2>Indirection Tactics</h2>
<p>Sometimes, analyzing the malware can tip off the controller. This is bad - they could target you, or release v2 of the malware. Ideally, the malware author / controller doesn't know you're analyzing their malware.</p>
<h3>Use Different Internet</h3>
<p>Without internet, you lose half the communication abilities of the malware. You want to use internet, just not your own.</p>
<p>Good ideas:</p>
<ul>
<li>Cell Connection
<ul>
<li>Hard (for the malware controllers) to geolocate</li>
</ul>
</li>
<li>VPN or SSH tunnel
<ul>
<li>Appear where you want to appear</li>
<li>Inside the targeted network,</li>
<li>or at least outside your house</li>
</ul>
</li>
<li>An ephemeral machine in a cloud
<ul>
<li>AWS / Azure</li>
</ul>
</li>
</ul>
<h3>Search Engines</h3>
<p>If you google a domain that google wasn't previously aware of, google might go crawl it.</p>
<blockquote>
<p>Prof. says visiting a site via wayback machine still queries images from the real site; I doubt this</p>
</blockquote>
<p>The <code>GetHostByName</code> function call initiates a DNS query. This is usually followed by <code>Connect</code>, which initiates a TCP handshake.</p>
<p>The American Registry for Internet Numbers (ARIN) holds the IP registry. DNS maps names to these IPs.</p>
<p>You can issue a DNS query - but there are online tools that can do it for you. Then the query comes from someone other than you. (Though <em>any</em> dns request can be an alert to the adversary.) Online tools can also reveal other metadata, like which other domains were registered at the same time, or geolocation data.</p>
<blockquote>
<p>But you can't trust geolocation data.</p>
</blockquote>
<h2>SNORT</h2>
<p>Snort is a popular IDS. Through rules and signatures, snort can generate alerts when something interesting is detected.</p>
<p>Generic snort format:</p>
<pre><code>rule header (rule options)
</code></pre>
<p>An example rule:</p>
<pre><code>alert tcp $HOME_NET any -&gt; $EXTERNAL_NET $HTTP_PORTS (msg:&quot;TROJAN Malicious User-Agent&quot;; content:&quot;|0d 0a|User-Agent\: Wefa7e&quot;; classtype:trojan-activity; sid:2000001; rev:1;)
</code></pre>
<p>In generic form:</p>
<ul>
<li>Header
<ul>
<li>alert
<ul>
<li>Generate an alert when this rule matches</li>
</ul>
</li>
<li>tcp
<ul>
<li>Match TCP traffic</li>
</ul>
</li>
<li>$HOME_NET any
<ul>
<li>Source IP - the local network</li>
<li>Source Port - <em>any</em> port - the client initiating the connection could use any dynamic port.</li>
</ul>
</li>
<li>$EXTERNAL_NET $HTTP_PORTS
<ul>
<li>Destination IP - some external network</li>
<li>Destination Port - HTTP / 80</li>
</ul>
</li>
</ul>
</li>
<li>Options
<ul>
<li>msg</li>
<li>content</li>
<li>classtype</li>
<li>sid</li>
<li>rev</li>
</ul>
</li>
</ul>
<blockquote>
<p>Out of time - Options will be completed next class!</p>
</blockquote>
<hr>
<p><a href="../../../">Index</a> &gt; <a href="./">Course</a> &gt; Mon Mar 08 2021 19:00:00 GMT-0500 (Eastern Standard Time):</p>

</article>
			
			<footer>
				<hr>
				<p>
					&copy; <a href="https://ewitherington.me">Ethan Witherington</a> 2022
				</p>
			</footer>
		</main>
	</body>

</html>