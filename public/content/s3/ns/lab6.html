<!DOCTYPE html>
<html lang=" en-US">

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		
	<!-- MathJax disabled on this page -->

		


		<!--[if lt IE 9]>
			<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
		<![endif]-->
		
		<style>
			@import url('https://fonts.googleapis.com/css2?family=Arvo&family=Fira+Mono&family=Open+Sans&display=swap');
		</style>
		<link rel="stylesheet" href="/styles/index.css?v=1657689426804">

		<!-- Code Highlighting -->
		<link rel="stylesheet" href="https://raw.githubusercontent.com/PrismJS/prism-themes/master/themes/prism-one-light.css">
	</head>

	<body>
		<main>
			
			


<article>
	<p><a href="./">up</a></p>
<h1>Network Services - Lab 6 - DNS part II</h1>
<blockquote>
<p>TODO - tell about the DNSSEC time sink and how to avoid it.</p>
</blockquote>
<h1>Activity Zero - VM setup</h1>
<ul>
<li>LambSauce
<ul>
<li>CentOS</li>
<li>Primary for myco</li>
<li>On bench machine 1, the 71 network.</li>
<li>IP: 10.150.71.2</li>
</ul>
</li>
<li>Wisdom
<ul>
<li>Windows Server</li>
<li>Secondary for myco</li>
<li>On bench machine 2, the 72 network.</li>
<li>IP: 10.150.72.2</li>
</ul>
</li>
</ul>
<p>More VMS will be added later, throughout the lab.</p>
<h1>Activity 1 - Make Wisdom a Primary for theirco</h1>
<h2>1.1</h2>
<p>The instructions go through this step-by-step - However, there are some clarifications:</p>
<ul>
<li>Step L
<ul>
<li>Use theirco instead of myco</li>
<li>Use any IP on your second network that does not cause conflicts.</li>
</ul>
</li>
</ul>
<h2>1.2</h2>
<p>Add the appropriate variant of the following to <code>/etc/named.conf</code></p>
<pre><code>zone &quot;theirco.abc1234.com&quot; {
	type slave;
	file &quot;slaves/theirco.abc1234.com&quot;;
	masters{
		10.150.72.2;
	};
};
</code></pre>
<p>The instructions imply that something needs to be added to the <code>options</code> section. This is false.</p>
<blockquote>
<p>My option section contains only <code>directory &quot;/var/named&quot;;</code> and not even that is needed.</p>
</blockquote>
<h2>1.3</h2>
<p>The instructions here are incomplete and inefficient. Perform these steps:</p>
<ul>
<li><code>systemctl stop named</code></li>
<li><code>rm -rf /var/named/slaves/</code></li>
<li>start a wireshark capture</li>
<li><code>systemctl start named</code></li>
<li>When the transfer has appeared, stop wireshark and save.</li>
<li>Have the wireshark open for the signoff.</li>
</ul>
<p>Convert the binary file to text with the following command, replacing abc1234 where needed:</p>
<pre><code>named-compilezone -f raw -F text -o /var/named/slaves/theirco.abc1234.com.dns theirco.abc1234.com /var/named/slaves/theirco.abc1234.com
</code></pre>
<ul>
<li>-f raw specifies the input is raw</li>
<li>-F text specifies to create an output file in text</li>
<li>-o (filename) is where to create the output file</li>
<li>The FQDN is specified</li>
<li>The final argument is the file to read</li>
</ul>
<p>Finally, <code>cat /var/named/slaves/theirco.abc1234.com.dns</code></p>
<h3>Signoff 1</h3>
<ul>
<li>Have the wireshark of the transfer open</li>
<li>Have the text zone file open</li>
</ul>
<h1>Activity 2</h1>
<h2>2.1</h2>
<p>Here we're creating another CentOS-BIND-DNS stack to serve a subdomain.</p>
<blockquote>
<p>The instructions have been using subnets</p>
</blockquote>
<h4>Create new VM</h4>
<p>On bench machine 1 (the 71 network for me), Full-clone the base CentOS_7.3 VM.</p>
<p>The instructions will call it CentOS2.</p>
<p>I will call it LOOOP.</p>
<h4>Configure Networking</h4>
<p>Use the GUI to set the ip information. I placed LOOOP on 71.100</p>
<h4>Update YUM:</h4>
<pre><code class="language-bash">yum clean all
yum --disablerepo=\* --enablerepo=base,extras,updates update
</code></pre>
<h4>Set the Hostname:</h4>
<p><code>hostnamectl set-hostname [name]</code></p>
<h4>Disable SELinux:</h4>
<ol>
<li><code>vim /etc/selinux/config</code></li>
<li>set <code>SELINUX=permissive</code></li>
<li>restart with <code>shutdown -r now</code></li>
</ol>
<p>Verify changes with <code>sestatus</code></p>
<h4>Install BIND:</h4>
<pre><code class="language-bash">yum -y install bind bind-utils
firewall-cmd --zone=public --permanent --add-service=dns
</code></pre>
<h4>Configure bind</h4>
<pre><code>vim /etc/named.conf

options{
	directory &quot;/var/named&quot;;
};
zone &quot;mgmt.myco.abc1234.com&quot; IN{
	type master;
	file &quot;mgmt.myco.abc1234.com.dns&quot;;
};
# Reverse zone here.
</code></pre>
<h4>Create Zone files.</h4>
<p>The <code>mgmt</code> domain needs two fake entries. Almost everything needed can be copy/pasted from CentOS1, or LambSauce in my case.</p>
<h4>Note on the reverse lookup file.</h4>
<p>I don't have subnets, so whichever server is set as DNS for a host will be the one they ask for reverse lookup.</p>
<h4>fin</h4>
<ul>
<li><code>named-checkconf</code></li>
<li><code>named-checkzone</code></li>
</ul>
<p>If both check commands are fine, and it starts, and <code>systemctl status named -l</code> looks okay, then it's probably okay.</p>
<h2>2.2 - Make sure it's okay.</h2>
<p>This section has two parts</p>
<h4>Table</h4>
<p>While the report does ask for a DNS topology, nothing needs to be done <em>In Lab</em> to create this, as long as you have notes somewhere of what VMs do what job.</p>
<h4>Network Traces</h4>
<p>Report question 3.1 asks about these network traces. You need two:</p>
<ul>
<li>A client asking CentOS1 about a host in mgmt
<ul>
<li>This fails, because CentOS1 doesn't know about mgmt</li>
</ul>
</li>
<li>A client asking CentOS2 about a host in mgmt
<ul>
<li>This should work</li>
</ul>
</li>
</ul>
<blockquote>
<p>This is where I got in my second lab section.</p>
</blockquote>
<h1>Informal, extra notes</h1>
<h2>How long did this take me?</h2>
<p>My first lab session was less productive than expected, due to a number of things I had to fix from lab5 and errors in the lab6 instructions. I hope those following my notes fare better.</p>
<p>Session | Time Spent | Progress
---|---
In Lab, Nov 19th | 2 Hours | Activity 1, signoff 1.
Lab Nov26th | 2 hours | Through 2.2, no signoff</p>

</article>
			
			<footer>
				<hr>
				<p>
					&copy; <a href="https://ewitherington.me">Ethan Witherington</a> 2022
				</p>
			</footer>
		</main>
	</body>

</html>